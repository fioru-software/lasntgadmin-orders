!function(){"use strict";var e={n:function(t){var a=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(a,{a:a}),a},d:function(t,a){for(var r in a)e.o(a,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:a[r]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},t=window.wp.element,a=window.wp.components,r=window.wp.apiFetch,n=e.n(r);const s=e=>{const[r,s]=(0,t.useState)(null),[l,d]=(0,t.useState)([]),[o,c]=(0,t.useState)(null),[i,u]=(0,t.useState)(!0),[m,p]=(0,t.useState)(!1);return(0,t.useEffect)((()=>{e.groupId&&s(e.groupId)}),[e.groupId]),(0,t.useEffect)((async()=>{try{u(!0),p(!0),n().use(n().createNonceMiddleware(e.nonce));const t=await n()({path:`${e.apiPath}`,method:"GET"});t.length||c({status:"warning",message:"You are not a member of any groups."}),d(t)}catch(e){c({status:"error",message:e.message}),console.error(e)}u(!1),e.groupId||p(!1)}),[]),(0,t.createElement)(t.Fragment,null,o&&(0,t.createElement)(a.Notice,{status:o.status,isDismissable:!0,onDismiss:()=>c(null)},o.message),i&&(0,t.createElement)(a.Spinner,null),!i&&(0,t.createElement)("select",{id:e.id,disabled:m,required:!0,onChange:function(t){e.setGroupId(t.target.value)}},!r&&(0,t.createElement)("option",{selected:!0,disabled:!0,value:""},"Please select"),l.map((e=>r==e.group_id?(0,t.createElement)("option",{selected:!0,key:e.group_id.toString(),value:e.group_id},e.name):(0,t.createElement)("option",{key:e.group_id.toString(),value:e.group_id},e.name)))),(0,t.createElement)("input",{type:"hidden",name:e.name,value:r}))},l=e=>{var r;const[s,l]=(0,t.useState)(!0),[d,o]=(0,t.useState)(!1);return(0,t.useEffect)((async()=>{try{l(!0),o(!0),n().use(n().createNonceMiddleware(e.nonce));const t=await n()({path:`${e.apiPath}/${e.groupId}`,method:"GET"});t.length||e.setNotice({status:"error",message:"No products are available for this group."}),e.setProducts(t)}catch(t){e.setNotice({status:"error",message:t.message}),console.error(t)}l(!1),o(!1)}),[e.groupId]),(0,t.createElement)(t.Fragment,null,s&&(0,t.createElement)(a.Spinner,null),!s&&(0,t.createElement)("select",{id:e.id,name:e.name,disabled:d,required:!0,onChange:e.onChange,value:null==e||null===(r=e.selectedProduct)||void 0===r?void 0:r.product_id},(0,t.createElement)("option",{selected:!0,disabled:!0,value:""},"Please select"),e.products.map((e=>"instock"===e.stock_status&&(0,t.createElement)("option",{key:e.id.toString(),"data-stock-quantity":e.stock_quantity,"data-price":e.price,value:e.id},e.name)))))},d=e=>{const a=(0,t.useRef)(null);return(0,t.createElement)("input",{name:e.name,id:e.id,type:"text",ref:a,defaultValue:e.default,required:e.required,pattern:e.pattern,disabled:e.disabled})},o=e=>{var r;const[n,s]=(0,t.useState)(null),[d,o]=(0,t.useState)(0),[c,i]=(0,t.useState)(0),[u,m]=(0,t.useState)(0),[p,f]=(0,t.useState)([]);return(0,t.useEffect)((()=>{s(null),o(null)}),[e.groupId]),(0,t.createElement)(t.Fragment,null,n&&(0,t.createElement)(a.Notice,{status:n.status,isDismissable:!0,onDismiss:()=>s(null)},n.message),(0,t.createElement)("div",{class:"form-wrap"},(0,t.createElement)("h3",null,"Product"),(0,t.createElement)("div",{class:"form-field"},(0,t.createElement)("label",{for:"product"},"Product"),(0,t.createElement)(l,{id:"product",name:"product",groupId:e.groupId,selectedProduct:e.lineItem,apiPath:e.apiPath,nonce:e.nonce,setNotice:s,onChange:function(e){const t=e.target.querySelector(`option[value="${e.target.value}"]`);o(parseInt(t.dataset.price))},setProducts:function(t){if(f(t),e.lineItem){const a=t.find((t=>e.lineItem.product_id===t.id)),r=parseInt(a.price);o(r),i(e.lineItem.quantity),m(r*e.lineItem.quantity)}},products:p})),(null==e||null===(r=e.lineItem)||void 0===r?void 0:r.id)&&(0,t.createElement)("input",{type:"hidden",name:"line_item_id",value:e.lineItem.id}),!!d&&p.length>0&&(0,t.createElement)(t.Fragment,null,(0,t.createElement)("div",{class:"form-field"},(0,t.createElement)("label",{for:"price"},"Price"),(0,t.createElement)("input",{id:"price",type:"number",disabled:!0,placeholder:"0",value:d}),(0,t.createElement)("input",{type:"hidden",name:"price",value:d})),(0,t.createElement)("div",{class:"form-field"},(0,t.createElement)("label",{for:"quantity"},"Quantity"),(0,t.createElement)("input",{id:"quantity",name:"quantity",type:"number",step:"1",min:"1",autocomplete:"off",placeholder:"0",onChange:function(e){const t=parseInt(e.target.value);i(t),m(t*d)},value:c,required:!0})),(0,t.createElement)("div",{class:"form-field"},(0,t.createElement)("label",{for:"total"},"Total"),(0,t.createElement)("input",{id:"total",type:"number",disabled:!0,placeholder:"0",value:u}),(0,t.createElement)("input",{type:"hidden",name:"total",value:u})))))},c=e=>{const[a,r]=(0,t.useState)(!1);return(0,t.useEffect)((()=>{e.selected===e.value&&r(!0)}),[e.selected]),(0,t.createElement)("option",{key:e.value,selected:a,value:e.value},e.children)},i=e=>{const[r,s]=(0,t.useState)([]),[l,d]=(0,t.useState)(null),[o,i]=(0,t.useState)(!0),[u,m]=(0,t.useState)(!0);return(0,t.useEffect)((async()=>{try{i(!0),n().use(n().createNonceMiddleware(e.nonce));const t=await n()({path:`${e.apiPath}/statuses`,method:"GET"});t.length||d({status:"warning",message:"Failed fetching order statuses."}),s(t)}catch(e){d({status:"error",message:e.message}),console.error(e)}i(!1)}),[]),(0,t.createElement)(t.Fragment,null,l&&(0,t.createElement)(a.Notice,{status:l.status,isDismissable:!0,onDismiss:()=>d(null)},l.message),o&&(0,t.createElement)(a.Spinner,null),!o&&(0,t.createElement)("select",{id:e.id,name:e.name,disabled:u,required:!0},(0,t.createElement)("option",{selected:!0,disabled:!0,value:""},"Please select"),r.map((a=>(0,t.createElement)(c,{value:a.id,selected:e.status},a.name)))))},u=e=>{const[a,r]=(0,t.useState)([]);return(0,t.useEffect)((()=>{r([{code:"CW",name:"Carlow"},{code:"CN",name:"Cavan"},{code:"CE",name:"Clare"},{code:"CO",name:"Cork"},{code:"DL",name:"Donegal"},{code:"D",name:"Dublin"},{code:"G",name:"Galway"},{code:"KY",name:"Kerry"},{code:"KE",name:"Kildare"},{code:"KK",name:"Kilkenny"},{code:"LS",name:"Laois"},{code:"LM",name:"Leitrim"},{code:"LK",name:"Limerick"},{code:"LD",name:"Longford"},{code:"LH",name:"Louth"},{code:"MO",name:"Mayo"},{code:"MH",name:"Meath"},{code:"MN",name:"Monaghan"},{code:"OY",name:"Offaly"},{code:"RN",name:"Roscommon"},{code:"SO",name:"Sligo"},{code:"TA",name:"Tipperary"},{code:"WD",name:"Waterford"},{code:"WH",name:"Westmeath"},{code:"WX",name:"Wexford"},{code:"WW",name:"Wicklow"}])}),[]),(0,t.createElement)("select",{id:e.id,name:e.name,required:!0},!e.selected&&(0,t.createElement)("option",{selected:!0,disabled:!0,value:""},"Please select"),a.map((a=>e.selected===a.code?(0,t.createElement)("option",{selected:!0,key:a.code,value:a.code},a.name):(0,t.createElement)("option",{key:a.code,value:a.code},a.name))))},m=e=>(0,t.createElement)("address",null,(0,t.createElement)("div",{class:"form-field"},(0,t.createElement)("label",{for:"address_1"},"Address line 1"),(0,t.createElement)(d,{name:"address_1",id:"address_1",default:e.order.billing.address_1||e.userMeta.billing_address_1,required:!0})),(0,t.createElement)("div",{class:"form-field"},(0,t.createElement)("label",{for:"address_2"},"Address line 2"),(0,t.createElement)(d,{name:"address_2",id:"address_2",default:e.order.billing.address_2||e.userMeta.billing_address_2,required:!0})),(0,t.createElement)("div",{class:"form-field"},(0,t.createElement)("label",{for:"city"},"City"),(0,t.createElement)(d,{name:"city",id:"city",default:e.order.billing.city||e.userMeta.billing_city,required:!0})),(0,t.createElement)("div",{class:"form-field"},(0,t.createElement)("label",{for:"postcode"},"Eircode"),(0,t.createElement)(d,{name:"postcode",id:"postcode",default:e.order.billing.postcode||e.userMeta.billing_postcode,required:!0})),(0,t.createElement)("div",{class:"form-field"},(0,t.createElement)("label",{for:"country"},"Country"),(0,t.createElement)("select",{id:"country",name:"country",required:!0},(0,t.createElement)("option",{value:"IE",selected:"selected"},"Ireland"))),(0,t.createElement)("div",{class:"form-field"},(0,t.createElement)("label",{for:"state"},"County"),(0,t.createElement)(u,{id:"state",name:"state",selected:e.order.billing.state||e.userMeta.billing_state}))),p=e=>{const[r,l]=(0,t.useState)(null),[c,u]=(0,t.useState)(null),[p,f]=(0,t.useState)({}),[E,g]=(0,t.useState)(!0),[_,h]=(0,t.useState)(!1);return(0,t.useEffect)((()=>{u(e.groupId)}),[e.groupId]),(0,t.useEffect)((()=>{f(e.order.line_items[0])}),e.order.line_items),(0,t.useEffect)((async()=>{}),[e.order.id]),(0,t.useEffect)((async()=>{}),[e.user.id]),(0,t.createElement)("form",{class:"panel-wrap woocommerce",onSubmit:async function(t){t.preventDefault();const a=function(e){const t={billing:{first_name:e.get("first_name"),last_name:e.get("last_name"),address_1:e.get("address_1"),address_2:e.get("address_2"),city:e.get("city"),state:e.get("state"),postcode:e.get("postcode"),country:e.get("country"),email:e.get("email"),phone:e.get("phone")},shipping:{},currency:e.get("currency"),customer_id:e.get("customer_id"),status:e.get("order_status"),meta_data:[{key:"groups-read",value:e.get("order_group")}],line_items:[{product_id:parseInt(e.get("product")),quantity:parseInt(e.get("quantity"))}]};return null!=p&&p.order_id&&(t.line_items=[{...t.line_items[0],id:p.id,order_id:p.order_id,price:parseInt(e.get("price")),subtotal:`${e.get("subtotal")}`,total:`${e.get("total")}`}]),t}(new FormData(t.target));try{l(null),g(!0),h(!0),n().use(n().createNonceMiddleware(e.nonce)),e.order=await n()({path:e.order.date_created?`/wc/v3/orders/${e.order.id}`:"/wc/v3/orders",method:e.order.date_created?"PUT":"POST",data:a}),l({status:"success",message:"Order created"}),document.location.assign("/wp-admin/edit.php?post_type=shop_order")}catch(t){l({status:"error",message:t.message}),console.error(t),g(!1),h(!1)}}},(0,t.createElement)("input",{type:"hidden",name:"email",value:e.order.billing.email||e.user.data.user_email}),(0,t.createElement)("input",{type:"hidden",name:"currency",value:e.order.currency||e.currency}),(0,t.createElement)("input",{type:"hidden",name:"customer_id",value:e.order.customer_id||e.user.ID}),(0,t.createElement)("div",{id:"order_data",class:"panel woocommerce-order-data"},(0,t.createElement)("div",{class:"form-wrap"},(0,t.createElement)("h3",null,"Personal"),(0,t.createElement)("div",{class:"form-field"},(0,t.createElement)("label",{for:"first_name"},"First name"),(0,t.createElement)(d,{name:"first_name",id:"first_name",default:e.order.billing.first_name||e.userMeta.first_name,required:!0})),(0,t.createElement)("div",{class:"form-field"},(0,t.createElement)("label",{for:"last_name"},"Last name"),(0,t.createElement)(d,{name:"last_name",id:"last_name",default:e.order.billing.last_name||e.userMeta.last_name,required:!0})),(0,t.createElement)("div",{class:"form-field"},(0,t.createElement)("label",{for:"phone"},"Phone"),(0,t.createElement)(d,{name:"phone",id:"phone",default:e.order.billing.phone||e.userMeta.billing_phone,required:!0}))),(0,t.createElement)("div",{class:"form-wrap"},(0,t.createElement)("h3",null,"Address"),(0,t.createElement)(m,{order:e.order,userMeta:e.userMeta})),(0,t.createElement)("div",{class:"form-wrap"},(0,t.createElement)("h3",null,"Order"),(0,t.createElement)("div",{class:"form-field"},(0,t.createElement)("label",{for:"order_group"},"Order group"),(0,t.createElement)(s,{groupId:c||e.groupId,id:"order_group",name:"order_group",apiPath:e.groupApiPath,nonce:e.nonce,setGroupId:u})),"auto-draft"!==e.order.status&&(0,t.createElement)("div",{class:"form-field"},(0,t.createElement)("label",{for:"order_status"},"Status"),(0,t.createElement)(i,{id:"order_status",name:"order_status",order:e.order,status:e.status,apiPath:e.orderApiPath,nonce:e.nonce}))),!!c&&(0,t.createElement)(t.Fragment,null,(0,t.createElement)("hr",null),(0,t.createElement)(o,{nonce:e.nonce,apiPath:e.productApiPath,lineItem:p,groupId:c})),(0,t.createElement)("div",{class:"form-wrap"},r&&(0,t.createElement)(a.Notice,{status:r.status,isDismissable:!0,onDismiss:()=>l(null)},r.message),(0,t.createElement)("button",{disabled:_,type:"submit",class:"button save_order button-primary",name:"save",value:"Create"},"auto-draft"===e.order.status?"Create":"Update"))))};window.addEventListener("load",(function(e){const a=document.querySelector("#lasntgadmin-orders-component");(0,t.render)((0,t.createElement)(p,{groupApiPath:a.dataset.groupApiPath,orderApiPath:a.dataset.orderApiPath,productApiPath:a.dataset.productApiPath,nonce:a.dataset.nonce,title:a.dataset.title,status:a.dataset.status,order:JSON.parse(a.dataset.order),orderId:a.dataset.orderId,groupId:JSON.parse(a.dataset.groupId),userId:a.dataset.userId,user:JSON.parse(a.dataset.user),userMeta:JSON.parse(a.dataset.userMeta)}),a)}),!1)}();