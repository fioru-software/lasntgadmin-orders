!function(){"use strict";var e={n:function(t){var a=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(a,{a:a}),a},d:function(t,a){for(var n in a)e.o(a,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:a[n]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},t=window.wp.element,a=window.wp.components,n=window.wp.apiFetch,l=e.n(n);const r=e=>{const[n,r]=(0,t.useState)(null),[d,s]=(0,t.useState)([]),[i,u]=(0,t.useState)(null),[o,c]=(0,t.useState)(!0),[m,p]=(0,t.useState)(!1);return(0,t.useEffect)((()=>{e.groupId&&r(e.groupId)}),[e.groupId]),(0,t.useEffect)((async()=>{try{c(!0),p(!0),l().use(l().createNonceMiddleware(e.nonce));const t=await l()({path:`${e.apiPath}`,method:"GET"});t.length||u({status:"warning",message:"You are not a member of any groups."}),s(t)}catch(e){u({status:"error",message:e.message}),console.error(e)}c(!1),e.groupId||p(!1)}),[]),(0,t.createElement)(t.Fragment,null,i&&(0,t.createElement)(a.Notice,{status:i.status,isDismissable:!0,onDismiss:()=>u(null)},i.message),o&&(0,t.createElement)(a.Spinner,null),!o&&(0,t.createElement)("select",{id:e.id,disabled:m,required:!0,onChange:function(t){e.setGroupId(t.target.value)},value:n},!n&&(0,t.createElement)("option",{selected:!0,disabled:!0,value:""},"Please select"),d.map((e=>(0,t.createElement)("option",{key:e.group_id.toString(),value:e.group_id},e.name)))),(0,t.createElement)("input",{type:"hidden",name:e.name,value:n}))};function d(e,t){const a=t.find((t=>t.key===`_quotas_field_${e}`));return void 0===a?0:a.value}const s=e=>{const[n,r]=(0,t.useState)(!0),[s,i]=(0,t.useState)(!1);function u(t){e.disabled||i(t)}return(0,t.useEffect)((()=>{i(e.disabled)}),[e.disabled]),(0,t.useEffect)((async()=>{try{r(!0),u(!0),l().use(l().createNonceMiddleware(e.nonce));const t=await l()({path:`${e.apiPath}/${e.groupId}`,method:"GET"});t.length||e.setNotice({status:"error",message:"No products are available for this group."}),e.setProducts(t)}catch(t){e.setNotice({status:"error",message:t.message}),console.error(t)}r(!1),u(!1)}),[e.groupId]),(0,t.createElement)(t.Fragment,null,n&&(0,t.createElement)(a.Spinner,null),!n&&(0,t.createElement)("select",{id:e.id,disabled:s,required:!0,onChange:e.onChange,value:null==e?void 0:e.productId},(0,t.createElement)("option",{selected:!0,disabled:!0,value:""},"Please select"),e.products.map((a=>{return(0,t.createElement)("option",{key:a.id.toString(),"data-stock":a.stock_quantity,"data-spaces":(n=a.stock_quantity,l=d(e.groupId,(r=a.meta_data,r.filter((e=>/_quotas_field_[\d]+/.test(e.key))))),n=parseInt(n),l=parseInt(l),isNaN(n)?0:isNaN(l)?n:0===l?l:l>n?n:l),"data-price":a.price,value:a.id},a.name);var n,l,r}))),(0,t.createElement)("input",{type:"hidden",name:e.name,value:null==e?void 0:e.productId}))},i=e=>{var n,l,r,d;const[i,u]=(0,t.useState)(null),[o,c]=(0,t.useState)(0),[m,p]=(0,t.useState)(0),[f,v]=(0,t.useState)(0),[E,g]=(0,t.useState)([]),[y,h]=(0,t.useState)(0),[b,_]=(0,t.useState)(0),[S,q]=(0,t.useState)(null);return(0,t.useEffect)((()=>{u(null),c(null)}),[null==e?void 0:e.groupId]),(0,t.useEffect)((()=>{var t;null!=e&&null!==(t=e.lineItem)&&void 0!==t&&t.id&&q(e.lineItem.id)}),[null==e||null===(n=e.lineItem)||void 0===n?void 0:n.id]),(0,t.createElement)(t.Fragment,null,i&&(0,t.createElement)(a.Notice,{status:i.status,isDismissable:!0,onDismiss:()=>u(null)},i.message),(0,t.createElement)("div",{class:"form-wrap"},(0,t.createElement)("h3",null,"Product"),(0,t.createElement)("div",{class:"form-field"},(0,t.createElement)("label",{for:"product"},"Product",(0,t.createElement)("span",{class:"required"}," *")),(0,t.createElement)(s,{id:"product",name:"product",disabled:!(null==e||null===(l=e.lineItem)||void 0===l||!l.id),groupId:e.groupId,productId:S,apiPath:e.apiPath,nonce:e.nonce,setNotice:u,onChange:function(t){const a=t.target.querySelector(`option[value="${t.target.value}"]`),n=parseInt(a.dataset.stock),l=parseInt(a.dataset.price),r=parseInt(a.dataset.spaces);c(l),h(r),_(n),p(0),v(0),q(a.value),r<1&&n>0?e.setStatus("waiting-list"):e.setStatus(e.order.status),u(n?{status:parseInt(a.dataset.spaces)>0?"info":"warning",message:`${a.dataset.spaces} spaces available.`}:{status:"error",message:"Out of stock"})},setProducts:function(t){if(g(t),null!=e&&e.lineItem){const a=t.find((t=>e.lineItem.product_id===t.id)),n=parseInt(a.price);c(n),p(e.lineItem.quantity),v(n*e.lineItem.quantity),q(e.lineItem.id)}},products:E})),(null==e||null===(r=e.lineItem)||void 0===r?void 0:r.id)&&(0,t.createElement)("input",{type:"hidden",name:"line_item_id",value:e.lineItem.id}),!!o&&E.length>0&&(0,t.createElement)(t.Fragment,null,(0,t.createElement)("div",{class:"form-field"},(0,t.createElement)("label",{for:"price"},"Price"),(0,t.createElement)("input",{type:"number",id:"price",disabled:!0,placeholder:"0",value:o}),(0,t.createElement)("input",{type:"hidden",name:"price",value:o})),(0,t.createElement)("div",{class:"form-field"},(0,t.createElement)("label",{for:"quantity"},"Quantity",(0,t.createElement)("span",{class:"required"}," *")),(0,t.createElement)("input",{type:"number",id:"quantity",disabled:!(null==e||null===(d=e.lineItem)||void 0===d||!d.id),step:"1",min:"1",max:y>0?y:b,autocomplete:"off",placeholder:"0",onChange:function(e){const t=parseInt(e.target.value);p(t),v(t*o)},value:m,required:!0}),(0,t.createElement)("input",{type:"hidden",name:"quantity",value:m})),(0,t.createElement)("div",{class:"form-field"},(0,t.createElement)("label",{for:"total"},"Total"),(0,t.createElement)("input",{type:"number",id:"total",type:"number",disabled:!0,placeholder:"0",value:f}),(0,t.createElement)("input",{type:"hidden",name:"total",value:f})))))},u=e=>{const[a,n]=(0,t.useState)(!1);return(0,t.useEffect)((()=>{e.selected===e.value&&n(!0)}),[e.selected]),(0,t.createElement)("option",{key:e.value,selected:a,value:e.value},e.children)},o=e=>{var n;const[r,d]=(0,t.useState)([]),[s,i]=(0,t.useState)(null),[o,c]=(0,t.useState)(!0),[m,p]=(0,t.useState)(!0);return(0,t.useEffect)((()=>{var t,a,n;"auto-draft"!==(null==e||null===(t=e.order)||void 0===t?void 0:t.status)&&null!=e&&null!==(a=e.user)&&void 0!==a&&null!==(n=a.allcaps)&&void 0!==n&&n.view_others_shop_orders&&p(!1)}),[null==e||null===(n=e.order)||void 0===n?void 0:n.status]),(0,t.useEffect)((()=>{}),[e.status]),(0,t.useEffect)((async()=>{try{c(!0),l().use(l().createNonceMiddleware(e.nonce));const t=await l()({path:`${e.apiPath}/statuses`,method:"GET"});t.length||i({status:"warning",message:"Failed fetching order statuses."}),d(t)}catch(e){i({status:"error",message:e.message}),console.error(e)}c(!1)}),[]),(0,t.createElement)(t.Fragment,null,s&&(0,t.createElement)(a.Notice,{status:s.status,isDismissable:!0,onDismiss:()=>i(null)},s.message),o&&(0,t.createElement)(a.Spinner,null),!o&&(0,t.createElement)("select",{id:e.id,disabled:m,required:!0,value:e.status,onChange:function(t){e.setStatus(t.target.value)}},"auto-draft"===e.status&&(0,t.createElement)("option",{selected:!0,value:"auto-draft"},"Draft"),"auto-draft"!==e.status&&(0,t.createElement)("option",{selected:!0,disabled:!0,value:""},"Please select"),r.map((e=>(0,t.createElement)(u,{value:e.id},e.name)))),"auto-draft"!==e.status&&(0,t.createElement)("input",{type:"hidden",name:e.name,value:null==e?void 0:e.status}))},c=e=>{const[a,n]=(0,t.useState)([]);return(0,t.useEffect)((()=>{n([{code:"CW",name:"Carlow"},{code:"CN",name:"Cavan"},{code:"CE",name:"Clare"},{code:"CO",name:"Cork"},{code:"DL",name:"Donegal"},{code:"D",name:"Dublin"},{code:"G",name:"Galway"},{code:"KY",name:"Kerry"},{code:"KE",name:"Kildare"},{code:"KK",name:"Kilkenny"},{code:"LS",name:"Laois"},{code:"LM",name:"Leitrim"},{code:"LK",name:"Limerick"},{code:"LD",name:"Longford"},{code:"LH",name:"Louth"},{code:"MO",name:"Mayo"},{code:"MH",name:"Meath"},{code:"MN",name:"Monaghan"},{code:"OY",name:"Offaly"},{code:"RN",name:"Roscommon"},{code:"SO",name:"Sligo"},{code:"TA",name:"Tipperary"},{code:"WD",name:"Waterford"},{code:"WH",name:"Westmeath"},{code:"WX",name:"Wexford"},{code:"WW",name:"Wicklow"}])}),[]),(0,t.createElement)("select",{id:e.id,name:e.name,required:!0},!e.selected&&(0,t.createElement)("option",{selected:!0,disabled:!0,value:""},"Please select"),a.map((a=>e.selected===a.code?(0,t.createElement)("option",{selected:!0,key:a.code,value:a.code},a.name):(0,t.createElement)("option",{key:a.code,value:a.code},a.name))))},m=e=>(0,t.createElement)("address",null,(0,t.createElement)("div",{class:"form-field"},(0,t.createElement)("label",{for:"address_1"},"Address line 1",(0,t.createElement)("span",{class:"required"}," *")),(0,t.createElement)("input",{type:"text",name:"address_1",id:"address_1",defaultValue:e.order.billing.address_1||e.userMeta.billing_address_1,required:!0})),(0,t.createElement)("div",{class:"form-field"},(0,t.createElement)("label",{for:"address_2"},"Address line 2"),(0,t.createElement)("input",{type:"text",name:"address_2",id:"address_2",defaultValue:e.order.billing.address_2||e.userMeta.billing_address_2})),(0,t.createElement)("div",{class:"form-field"},(0,t.createElement)("label",{for:"city"},"City",(0,t.createElement)("span",{class:"required"}," *")),(0,t.createElement)("input",{type:"text",name:"city",id:"city",defaultValue:e.order.billing.city||e.userMeta.billing_city,required:!0})),(0,t.createElement)("div",{class:"form-field"},(0,t.createElement)("label",{for:"state"},"County",(0,t.createElement)("span",{class:"required"}," *")),(0,t.createElement)(c,{id:"state",name:"state",selected:e.order.billing.state||e.userMeta.billing_state,required:!0})),(0,t.createElement)("div",{class:"form-field"},(0,t.createElement)("label",{for:"postcode"},"Eircode",(0,t.createElement)("span",{class:"required"}," *")),(0,t.createElement)("input",{type:"text",name:"postcode",id:"postcode",defaultValue:e.order.billing.postcode||e.userMeta.billing_postcode,required:!0})),(0,t.createElement)("div",{class:"form-field"},(0,t.createElement)("label",{for:"country"},"Country",(0,t.createElement)("span",{class:"required"}," *")),(0,t.createElement)("select",{id:"country",name:"country",required:!0},(0,t.createElement)("option",{value:"IE",selected:"selected"},"Ireland")))),p=e=>{var n,d;const[s,u]=(0,t.useState)(null),[c,p]=(0,t.useState)(null),[f,v]=(0,t.useState)({}),[E,g]=(0,t.useState)(!1),[y,h]=(0,t.useState)(!1),[b,_]=(0,t.useState)(""),[S,q]=(0,t.useState)("Create");return(0,t.useEffect)((()=>{p(e.groupId)}),[e.groupId]),(0,t.useEffect)((()=>{_(e.status),"auto-draft"!==e.status&&q("Update")}),[e.status]),(0,t.useEffect)((()=>{"waiting-list"===b?q("Add to waiting list"):"auto-draft"===(null==e?void 0:e.status)?q("Create"):q("Update")}),[b]),(0,t.useEffect)((()=>{v(e.order.line_items[0])}),e.order.line_items),(0,t.useEffect)((async()=>{}),[null==e||null===(n=e.order)||void 0===n?void 0:n.id]),(0,t.useEffect)((async()=>{}),[null==e||null===(d=e.user)||void 0===d?void 0:d.id]),(0,t.useEffect)((()=>{}),[null==e?void 0:e.user]),(0,t.useEffect)((()=>{}),[null==e?void 0:e.userMeta]),(0,t.createElement)("form",{class:"panel-wrap woocommerce",onSubmit:async function(t){t.preventDefault();const a=function(e){const t={billing:{first_name:e.get("first_name"),last_name:e.get("last_name"),address_1:e.get("address_1"),address_2:e.get("address_2"),city:e.get("city"),state:e.get("state"),postcode:e.get("postcode"),country:e.get("country"),email:e.get("email"),phone:e.get("phone")},shipping:{},currency:e.get("currency"),customer_id:e.get("customer_id"),status:e.get("order_status"),meta_data:[{key:"groups-read",value:e.get("order_group")}],line_items:[{product_id:parseInt(e.get("product")),quantity:parseInt(e.get("quantity"))}]};return null!=f&&f.order_id&&(t.line_items=[{...t.line_items[0],id:f.id,order_id:f.order_id,price:parseInt(e.get("price")),subtotal:`${e.get("subtotal")}`,total:`${e.get("total")}`}]),t}(new FormData(t.target)),n=e.order.date_created?"PUT":"POST";try{u(null),g(!0),h(!0),l().use(l().createNonceMiddleware(e.nonce)),e.order=await l()({path:e.order.date_created?`/wc/v3/orders/${e.order.id}`:"/wc/v3/orders",method:n,data:a}),u({status:"success",message:"auto-draft"===(null==e?void 0:e.status)?"Order created. Please wait to be redirected...":"Please wait to be redirected..."}),document.location.assign("POST"===n?`/wp-admin/post.php?post=${e.order.id}&action=edit&tab=attendees`:"/wp-admin/post.php?post=${ props.order.id }&action=edit&tab=order")}catch(t){u({status:"error",message:t.message}),console.error(t),g(!1),h(!1)}}},(0,t.createElement)("input",{type:"hidden",name:"email",value:e.order.billing.email||e.user.data.user_email}),(0,t.createElement)("input",{type:"hidden",name:"currency",value:e.order.currency||e.currency}),(0,t.createElement)("input",{type:"hidden",name:"customer_id",value:e.order.customer_id||e.user.ID}),(0,t.createElement)("div",{id:"order_data",class:"panel woocommerce-order-data"},(0,t.createElement)("div",{class:"form-wrap"},(0,t.createElement)("h3",null,"Personal"),(0,t.createElement)("div",{class:"form-field"},(0,t.createElement)("label",{for:"first_name"},"First name",(0,t.createElement)("span",{class:"required"}," *")),(0,t.createElement)("input",{type:"text",name:"first_name",id:"first_name",defaultValue:e.order.billing.first_name||e.userMeta.first_name,required:!0})),(0,t.createElement)("div",{class:"form-field"},(0,t.createElement)("label",{for:"last_name"},"Last name",(0,t.createElement)("span",{class:"required"}," *")),(0,t.createElement)("input",{type:"text",name:"last_name",id:"last_name",defaultValue:e.order.billing.last_name||e.userMeta.last_name,required:!0})),(0,t.createElement)("div",{class:"form-field"},(0,t.createElement)("label",{for:"phone"},"Phone",(0,t.createElement)("span",{class:"required"}," *")),(0,t.createElement)("input",{type:"tel",name:"phone",id:"phone",defaultValue:e.order.billing.phone||e.userMeta.billing_phone,required:!0}))),(0,t.createElement)("div",{class:"form-wrap"},(0,t.createElement)("h3",null,"Address"),(0,t.createElement)(m,{order:e.order,userMeta:e.userMeta})),(0,t.createElement)("div",{class:"form-wrap"},(0,t.createElement)("h3",null,"Order"),(0,t.createElement)("div",{class:"form-field"},(0,t.createElement)("label",{for:"order_status"},"Status",(0,t.createElement)("span",{class:"required"}," *")),(0,t.createElement)(o,{id:"order_status",name:"order_status",user:null==e?void 0:e.user,order:null==e?void 0:e.order,status:b,setStatus:_,apiPath:e.orderApiPath,nonce:e.nonce})),(0,t.createElement)("div",{class:"form-field"},(0,t.createElement)("label",{for:"order_group"},"Order group",(0,t.createElement)("span",{class:"required"}," *")),(0,t.createElement)(r,{groupId:c||e.groupId,id:"order_group",name:"order_group",apiPath:e.groupApiPath,nonce:e.nonce,setGroupId:p}))),!!c&&(0,t.createElement)(t.Fragment,null,(0,t.createElement)("hr",null),(0,t.createElement)(i,{nonce:e.nonce,apiPath:e.productApiPath,lineItem:f,order:e.order,groupId:c,setStatus:_})),(0,t.createElement)("div",{class:"form-wrap"},(0,t.createElement)("div",{class:"form-field"},s&&(0,t.createElement)(a.Notice,{status:s.status,isDismissable:!0,onDismiss:()=>u(null)},s.message),(0,t.createElement)("button",{disabled:y,type:"submit",class:"button save_order button-primary",name:"save",value:"Create"},S),E&&(0,t.createElement)(a.Spinner,null)))))},f=e=>{const[a,n]=(0,t.useState)("");return(0,t.useEffect)((()=>{n(e.defaultValue)}),[e.defaultValue]),(0,t.createElement)("select",{id:e.id,name:e.name,disabled:(null==e?void 0:e.disabled)||!1,required:(null==e?void 0:e.required)||!1,value:a,onChange:function(e){n(e.target.value)}},!e.value&&!e.defaultValue&&(0,t.createElement)("option",{disabled:!0,value:""},"Please select"),e.children)},v=e=>{const a=(0,t.useRef)(null);return(0,t.createElement)("input",{name:e.name,id:e.id,type:"text",ref:a,maxlength:(null==e?void 0:e.maxlength)||32,minlength:(null==e?void 0:e.minlength)||1,defaultValue:null==e?void 0:e.defaultValue,placeholder:null==e?void 0:e.placeholder,required:(null==e?void 0:e.required)||!1,pattern:null==e?void 0:e.pattern,readonly:(null==e?void 0:e.readonly)||!1,disabled:(null==e?void 0:e.disabled)||!1})},E=e=>{const a=(0,t.useRef)(null);return(0,t.createElement)("input",{name:e.name,id:e.id,type:"email",ref:a,maxlength:(null==e?void 0:e.maxlength)||32,minlength:(null==e?void 0:e.minlength)||1,defaultValue:null==e?void 0:e.defaultValue,placeholder:null==e?void 0:e.placeholder,required:(null==e?void 0:e.required)||!1,pattern:(null==e?void 0:e.pattern)||"^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$",readonly:(null==e?void 0:e.readonly)||!1,disabled:(null==e?void 0:e.disabled)||!1})},g=e=>{const a=(0,t.useRef)(null);return(0,t.createElement)("input",{name:e.name,id:e.id,type:"date",ref:a,defaultValue:null==e?void 0:e.defaultValue,placeholder:null==e?void 0:e.placeholder,required:(null==e?void 0:e.required)||!1,pattern:(null==e?void 0:e.pattern)||"^d{4}-d{2}-d{2}$",readonly:(null==e?void 0:e.readonly)||!1,disabled:(null==e?void 0:e.disabled)||!1})},y=e=>{const a=(0,t.useRef)(null);return(0,t.createElement)("input",{name:e.name,id:e.id,type:"number",ref:a,defaultValue:null==e?void 0:e.defaultValue,placeholder:null==e?void 0:e.placeholder,required:(null==e?void 0:e.required)||!1,pattern:(null==e?void 0:e.pattern)||"^d+",readonly:(null==e?void 0:e.readonly)||!1,max:null==e?void 0:e.max,min:(null==e?void 0:e.min)||0,step:(null==e?void 0:e.step)||1,disabled:(null==e?void 0:e.disabled)||!1,onChange:null==e?void 0:e.onChange,value:null==e?void 0:e.value})},h=e=>{var a,n;return(0,t.createElement)(t.Fragment,null,(0,t.createElement)("h3",null,"Attendee ",e.index+1),(null==e||null===(a=e.attendee)||void 0===a?void 0:a.ID)&&(0,t.createElement)("input",{type:"hidden",name:`attendees[${e.index}]['id']`,value:e.attendee.ID}),(null==e||null===(n=e.attendee)||void 0===n?void 0:n.post_status)&&(0,t.createElement)("input",{type:"hidden",name:`attendees[${e.index}]['status']`,value:e.attendee.post_status}),null==e?void 0:e.fields.map((a=>{var n,l,r,d,s,i,u;return(0,t.createElement)("div",{class:"form-field"},(0,t.createElement)("label",{for:a.key},a.label,!!a.required&&(0,t.createElement)("span",{class:"required"}," *")),"text"===a.type&&(0,t.createElement)(v,{id:a.key,name:`attendees[${e.index}][${a.prefix}][${a.name}]`,disabled:e.disabled,placeholder:a.placeholder,defaultValue:(null==e||null===(n=e.attendee)||void 0===n?void 0:n.acf[a.name])||a.default_value,maxlength:a.maxlength,required:!!a.required}),"email"===a.type&&(0,t.createElement)(E,{id:a.key,name:`attendees[${e.index}][${a.prefix}][${a.name}]`,disabled:e.disabled,placeholder:a.placeholder,defaultValue:(null==e||null===(l=e.attendee)||void 0===l?void 0:l.acf[a.name])||a.default_value,maxlength:a.maxlength,required:!!a.required}),"textarea"===a.type&&(0,t.createElement)("textarea",{id:a.key,disabled:e.disabled,name:`attendees[${e.index}][${a.prefix}][${a.name}]`,defaultValue:(null==e||null===(r=e.attendee)||void 0===r?void 0:r.acf[a.name])||a.default_value}),"date_picker"===a.type&&(0,t.createElement)(g,{id:a.key,name:`attendees[${e.index}][${a.prefix}][${a.name}]`,disabled:e.disabled,defaultValue:(null==e||null===(d=e.attendee)||void 0===d?void 0:d.acf[a.name])||a.default_value}),"true_false"===a.type&&(0,t.createElement)("input",{type:"checkbox",id:a.key,name:`attendees[${e.index}][${a.prefix}][${a.name}]`,disabled:e.disabled,required:!!a.required,defaultValue:(null==e||null===(s=e.attendee)||void 0===s?void 0:s.acf[a.name])||a.default_value}),"number"===a.type&&(0,t.createElement)(y,{id:a.key,name:`attendees[${e.index}][${a.prefix}][${a.name}]`,disabled:e.disabled,defaultValue:(null==e||null===(i=e.attendee)||void 0===i?void 0:i.acf[a.name])||a.default_value}),"select"===a.type&&(0,t.createElement)(f,{id:a.key,name:`attendees[${e.index}][${a.prefix}][${a.name}]`,disabled:e.disabled,required:!!a.required,defaultValue:(null==e||null===(u=e.attendee)||void 0===u?void 0:u.acf[a.name])||a.default_value||""},Object.keys(a.choices).map(((e,n)=>(0,t.createElement)("option",{key:e,value:"local_authority"===a.name?e:a.choices[e]},a.choices[e])))))})),(0,t.createElement)("hr",null))};var b=window.lodash;const _=e=>{const[n,r]=(0,t.useState)(null),[d,s]=(0,t.useState)(0),[i,u]=(0,t.useState)(!1),[o,c]=(0,t.useState)(!1),[m,p]=(0,t.useState)("Save");function f(e,t){return Array.from(t.querySelectorAll(`[name^="attendees[${e}][acf]"]`)).filter((e=>""!==e.value)).map((e=>[v(e.getAttribute("name")),e.value]))}function v(e){const t=e.match(/attendees\[\d\]\[acf\]\[(.+)\]/);return t?t[1]:null}return(0,t.useEffect)((()=>{(null==e?void 0:e.quantity)>0?s(parseInt(e.quantity)):r({status:"warning",message:"Please add a product to your order"})}),[e.quantity]),(0,t.useEffect)((()=>{}),[e.fields]),(0,t.useEffect)((()=>{}),[e.attendees]),(0,t.createElement)(t.Fragment,null,(0,t.createElement)("div",{class:"form-wrap"},(0,t.createElement)("form",{class:"panel-wrap woocommerce",onSubmit:async function(t){t.preventDefault();const a=function(t,a,n,l){return(0,b.range)(t).map((t=>function(t,a,n,l){const r=new FormData(a),d=r.has(`attendees[${t}]['id']`)?parseInt(r.get(`attendees[${t}]['id']`)):null;return{path:d?`/wp/v2/attendee/${d}?order_id=${l}`:`/wp/v2/attendee?order_id=${l}`,method:"POST",body:{id:d,status:r.has(`attendees[${t}]['status']`)?r.get(`attendees[${t}]['status']`):"publish",meta:{"groups-read":parseInt(e.groupId),attendee_order_ids:e.order.id},acf:Object.assign(Object.fromEntries(f(t,a)))}}}(t,a,0,l)))}(d,t.target,parseInt(e.groupId),e.order.id);try{r(null),c(!0),u(!0),l().use(l().createNonceMiddleware(e.nonce)),await l()({path:"/batch/v1",method:"POST",data:{requests:a}}),r({status:"success",message:"Attendees added. Please wait to be redirected..."}),document.location.assign(`/wp-admin/post.php?post=${e.order.id}&action=edit&tab=payment`)}catch(t){r({status:"error",message:t.message}),console.error(t),c(!1),u(!1)}}},n&&(0,t.createElement)(a.Notice,{status:n.status,isDismissable:!0,onDismiss:()=>r(null)},n.message),(0,t.createElement)("div",{id:"order_data",class:"panel woocommerce-order-data"},(null==e?void 0:e.quantity)>0&&(0,b.range)(d).map((a=>(0,t.createElement)(h,{fields:e.fields,attendee:e.attendees[a],index:a,disabled:i}))),(null==e?void 0:e.quantity)>0&&(0,t.createElement)("div",{class:"form-field"},(0,t.createElement)("button",{disabled:i,type:"submit",class:"button save_order button-primary",name:"save",value:"Create"},m),o&&(0,t.createElement)(a.Spinner,null))))))};window.addEventListener("load",(function(e){const a=document.querySelector("#lasntgadmin-orders-form");a&&(0,t.render)((0,t.createElement)(p,{groupApiPath:a.dataset.groupApiPath,orderApiPath:a.dataset.orderApiPath,productApiPath:a.dataset.productApiPath,nonce:a.dataset.nonce,title:a.dataset.title,status:a.dataset.status,order:JSON.parse(a.dataset.order),orderId:a.dataset.orderId,groupId:JSON.parse(a.dataset.groupId),userId:a.dataset.userId,user:JSON.parse(a.dataset.user),userMeta:JSON.parse(a.dataset.userMeta)}),a);const n=document.querySelector("#lasntgadmin-orders-attendees");n&&(0,t.render)((0,t.createElement)(_,{quantity:n.dataset.quantity,nonce:n.dataset.nonce,fields:JSON.parse(n.dataset.fields),order:JSON.parse(n.dataset.order),groupId:JSON.parse(n.dataset.groupId),attendees:JSON.parse(n.dataset.attendees)}),n)}),!1)}();